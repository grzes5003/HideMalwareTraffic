import pandas as pd
import matplotlib.pyplot as plt

d_loss = 'd_loss'
g_loss = 'g_loss'


def plot_learning_curve(path):
    df = pd.read_csv(path)
    plt.plot(df[d_loss], label=d_loss)
    plt.plot(df[g_loss], label=g_loss)
    plt.xlabel('Epoch')
    plt.ylabel('Loss')
    plt.legend()
    plt.title('Loss function in epochs')
    plt.show()


def plot_distribution(path1, path2, compare_column='Dur'):
    df1 = pd.read_csv(path1)
    df2 = pd.read_csv(path2)

    fig = plt.figure()

    ax1, ax2 = fig.add_subplot(211)
    ax3 = fig.add_subplot(212)

    df1[compare_column].plot.kde(ax=ax1)
    df2[compare_column].plot.kde(ax=ax2)

    ax1.plot(label='Anomaly')
    ax2.plot(label='Normal')
    fig.legend()
    plt.title(f'Density of {compare_column}')
    plt.show()
    print('k')


if __name__ == '__main__':
    # plot_learning_curve('..\\saved_data\\learning_logs\\wgan_pg_100_01.log')
    plot_distribution('..\\saved_data\\wgan_gp_data_generated_4_desc.csv',
                      '..\\saved_data\\custom_data\\p2_quic_yt_prepared2.csv')
