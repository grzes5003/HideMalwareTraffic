from blackBoxIPS.EncoderIPSkddTrain import EncoderIPSkddTrain
from sklearn.model_selection import train_test_split
import pandas as pd


def func():
    df_attack = pd.read_csv('saved_data/df_attack.csv')
    df_normal = pd.read_csv('saved_data/KDDTrainData/df_normal.csv')

    df_normal.drop('Unnamed: 0', axis=1, inplace=True)
    df_attack.drop('Unnamed: 0', axis=1, inplace=True)

    x_normal = df_normal.values
    x_attack = df_attack.values

    x_attack1, x_attack2 = train_test_split(
        x_attack, test_size=0.25, random_state=31)
    x_attack3, x_attack4 = train_test_split(
        x_attack, test_size=0.60, random_state=16)

    x_normal_train1, _ = train_test_split(
        x_normal, test_size=0.25, random_state=32)
    x_normal_train2, _ = train_test_split(
        x_normal, test_size=0.30, random_state=76)
    x_normal_train3, _ = train_test_split(
        x_normal, test_size=0.20, random_state=13)

    enc_ips = EncoderIPSkddTrain()
    score1 = enc_ips.rate_flow(x_attack)
    score2 = enc_ips.rate_flow(x_attack1)
    score3 = enc_ips.rate_flow(x_attack3)
    score4 = enc_ips.rate_flow(x_normal_train1)
    score5 = enc_ips.rate_flow(x_normal_train2)
    score6 = enc_ips.rate_flow(x_normal_train3)

    print(f'attack result = {score1}')
    print(f'attack result = {score2}')
    print(f'attack result = {score3}')
    print(f'normal result = {score4}')
    print(f'normal result = {score5}')
    print(f'normal result = {score6}')


if __name__ == '__main__':
    func()
