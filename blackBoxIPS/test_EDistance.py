from blackBoxIPS.EDistance import EDistance
from util.data_constants import GEN
from unittest import TestCase
import json


class TestEDistance(TestCase):
    def test_rate_flow(self):
        cols = ['Dur', 'sTos', 'dTos', 'SrcBytes', 'DstBytes', 'SrcLoad',
                'DstLoad', 'SrcRate', 'DstRate', 'SrcPkts', 'DstPkts', 'daytime']
        res = EDistance.rate_flow(f'..\\saved_data\\wgan_{GEN}_data_generated_0_desc_cont_prepared.csv',
                                  '..\\saved_data\\custom_data\\p2_spotify_cont_prepared.csv', cols)
        print(json.dumps([(col, r) for col, r in zip(cols, res)]))
