from GAN.modules.modelBases import noise_dim
from util.preprocessors import quantify_data
from unittest import TestCase
import tensorflow as tf
import numpy as np
import keras
import os


class TestWganGP(TestCase):
    def test_generate_data(self):
        g_model = keras.models.load_model('..\\saved_models\\RF_03\\gen')

        random_latent_vectors = tf.random.normal(shape=(3000, noise_dim))
        generated_images = g_model(random_latent_vectors)

        arr = np.array(generated_images)
        arr = np.squeeze(arr)

        i = 0
        while os.path.exists(f'..\\saved_data\\wgan_gp_data_generated_{i}.csv'):
            i += 1

        np.savetxt(f'..\\saved_data\\wgan_gp_data_generated_{i}.csv', arr, delimiter=',')

        quantify_data(f'..\\saved_data\\wgan_gp_data_generated_{i}.csv')
